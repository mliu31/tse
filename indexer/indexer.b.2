/* indexer.c --- 
 * 
 * 
 * Author: Agon Hoxha
 * Created: Tue Oct 26 19:04:11 2021 (-0400)
 * Version: 
 * 
 * Description: 
 * 
 */

#include <stdio.h>
#include <ctype.h>
#include <pageio.h>
#include <webpage.h>

/*typedef struct index_t {

	char *word;
	int freq;

	} id_t; */

int NormalizeWord(char **wordptr) {

	char *word = *wordptr;
	int i = 0;

	while(word[i] != '\0') {
		
		if(isalpha(word[i]) == 0) {
			free(word);
			return -1;
		}

		word[i] = ((char)(((int)tolower(word[i]))));

		i++;
		
	}

	if(i < 4) {
		free(word);
		return -1;
	}

	return 0;

}

int main(void) {

	webpage_t *loadedpage;
	char *word;
	int pos = 0;

	loadedpage = pageload(1, "../pages/");

	while(true) {

		pos = webpage_getNextWord(loadedpage, pos, &word);

		if(pos == -1) {
			break;
		}

		if(NormalizeWord(&word) == 0) {
			printf("%s\n", word);
			free(word);
		}

	}

	webpage_delete(loadedpage);

	return 0;

}
